\chapter{Results} \label{sec:study_results}

This Chapter describes all the results gathered throughout the study in a per RQ basis. This approach increase the traceability of the findings within the report as suggested by Runeson et al. \cite{case_study_software_engineering} (Item 20 in Appendix \ref{checklist_for_case_studies}).

Furthermore, for each research question the following schema is used. Firstly, they contain results yielded by the thematic analysis performed on archival records. Subsequently, for each relevant theme, they report the validation results obtained through semi-structured interviews described in section \ref{sec:semi-structured_interviews} or, where possible, results obtained through quantitative metrics.

\section{Research Question 1}

As defined in the Introduction chapter, the goal of this Research Question is to evaluate which aspects of Source Code decay are applicable to the Test code. The first phase of the study inspected the available documentation and meta-documentation sources in order to define the most relevant problems that, subsequently, have been analyzed through with quantitive metrics and validated through semi structured Interviews.

The thematic analysis revealed the codes listed in Table \ref{tab:themes_rq1}. Furthermore, Fig. \ref{fig:rq1_sources} reports the number of mentions of such codes on a per source basis.



\begin{table}
\renewcommand{\arraystretch}{1.5}
\centering
\begin{tabular}{ c p{4.3cm} p{4.6cm}}

    \hline
    {\large Global Theme} & {\large Organizing Theme} & {\large Codes}\\
    \hline

    \multirow{4}{*}{\parbox[t]{4.3cm}{
        Source code bad habits that also arise in Test code}
    } & \multirow{2}{*}{\parbox[t]{4.3cm}{Modularity related issues}}
        & Complex functions \\
        & & DRY violations\\
        & & Single responsibility violations\\ \cline{2-3}

    & \multirow{2}{*}{\parbox[t]{4.6cm}{Line related issues}}
        & Complex statements \\
        & & Arity problems \\
    \hline
\end{tabular}
\caption{Themes and codes related to RQ1 extrapolated from qualitative sources}
\label{tab:themes_rq1}
\end{table}

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth,keepaspectratio]{figure/results/rq1/sources.pdf}
    \caption{Codes with relatives Data sources for research question 1}
    \label{fig:rq1_sources}
\end{figure}



\subsection{DRY violations}
    The DRY principle stands for \textit{``Don't Repeat Yourself''} and indicates the best practice of factoring out common logic in a separate entity to enhance code reuse.

    Violation of this principle can be due several reasons and tends to greatly impact the maintainability efforts of the code base since a modification must be propagated throughout the code base a number of times equal to the number of copies of the logic interested.

    However, considering the richness of the scripting language provided by UFT, there is more than way to achieve a goal and hence static analysis on the source code was not applicable. For this reason, only manual analysis of the repositories was used to create findings that have been validated through semi-structured interviews. This inquiry revealed that DRY violations occur on at least three levels. Namely \textit{within a single repository}, \textit{within a single project}, and \textit{between projects}.


\subsection{Function complexity}
    The metric used to evaluate this Technical Debt Item is the well know cyclomatic complexity proposed by McCabe \cite{cyclomatic_complexity}.

    Figure \ref{fig:avg-complexity-together} shows the result for all the four projects under study for this metric. On the X-axis revision index that marks the subsequent revision in the source version control. Therefore, it represent a relative time unit. The ordinates' axis instead report the value of the \textit{average} cyclomatic complexity at function level.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth,keepaspectratio]{figure/results/rq1/avg-complexity-together.pdf}
    \caption{Evolution of cyclomatic complexity in studied projects over time.}
    \label{fig:avg-complexity-together}
\end{figure}


\subsection{Single responsibility violations}
    Single responsibility violations are the problems that arise whenever a logical entity, e.g.\ functions, exceeds its logical boundaries and hence incorporates logic that in an optimal solution would be placed in other logical constructs.

    Given the richness of the UFT scripting language a static analysis of the code base was not possible. In fact, it would require advance analysis techniques that use semantics of constructs and varaibles  and function names. This was outside the boundaries of this Thesis work. Therefore, the inquiry, whose results are discussed in section \ref{sec:res-single-responsability-vilation}, is more qualitative and highlights the perception developers have when dealing with source code polluted with this TD item.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth,keepaspectratio]{figure/results/rq1/avg-length-together.pdf}
    \caption{Evolution of average function length in studied projects over time.}
    \label{fig:avg-length-together}
\end{figure}


\subsection{Complex statements}
This problem arises when the code includes statements that execute several operations at once. As steted by Stemlos et al. \cite{metrics_source_code}, a high number of such statements hinders understandability and readability of the code base.

A common accepted threshold is based on the number of characters used in a line. A number greater that eighty is considered too high and hence must be indented or the statement should be broken down in several sub-statements.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth,keepaspectratio]{figure/results/rq1/perc-complex-statements.pdf}
    \caption{Evolution of the percentage of complex statements in studied projects over time.}
    \label{fig:perc-complex-statements}
\end{figure}



\FloatBarrier

\section{Research Question 2}
%
The scope of User Interface tests is to validate the state of the User Interface after a predefined series of actions occurred. However, this entails a different use for the constructs compared to conventional source code and possibly new ones specific for these use cases. For this reason the second RQ will inspect these unique items.

However, keeping into account the differences between property based testing and image recognition testing is important. The former uses property or meta-properties of UI components to identify them and simulate user events over them. The latter, instead, uses image recognition algorithms to identify such widgets. This different identification method imposes different approached when creating the test suite that are analyzed separately in the following sections, presenting both quantitative and qualitative results.



\begin{table}
\renewcommand{\arraystretch}{1.5}
\centering
\begin{tabular}{ c p{4.3cm} p{4.6cm}}

    \hline
    {\large Global Theme} & {\large Organizing Theme} & {\large Codes}\\
    \hline

    \multirow{7}{*}{\parbox[b]{4.3cm}{
        User interface testware specific issues
    }
    } & \multirow{4}{*}{\parbox[c]{4.3cm}{Image recognition problems}}
        & Too sensitive \\
        & & False positive and negative results\\
        & & Not reusable\\
        & & Not suitable for responsive environments (e.g. web applications)\\ \cline{2-3}

    & Property based problems & Impossible to foresee when it will break\\ \cline{2-3}

    & Coordinated based problems  & Too fragile\\ \cline{2-3}

    & UFT specific problems & Based on binary files\\

    \hline
\end{tabular}
\caption{Themes and codes related to RQ1 extrapolated from qualitative sources}
\label{tab:themes_rq2}
\end{table}

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth,keepaspectratio]{figure/results/rq2/sources.png}
    \caption{Codes with relatives Data sources for research question 2}
    \label{fig:rq2_sources}
\end{figure}



\section{Research Question 3}
As mentioned before, the goal of this research question is to evaluate the impact of the Technical Debts items identified in RQ 1 and 2. However, considering the exploratory nature of this Thesis work and the scarcity of resources, results are reported in Table \ref{tab:interest_magnitude} using a normal Likert's scale \cite{likert-scale}. The table includes the interviewee ID, the grade assigned and for each item the average calculated.

\begin{table}[!htbp]
	\centering
	\tabulinesep=1.2mm
	\begin{tabu} to \textwidth {|X[2]|X|X|X|}

		\hline
		\textbf{TD item} & \textbf{Interviewee 3} & \textbf{Interviewee 4}  & \textbf{Average} \\
		\hline

		Function complexity & 3 & 5 & 4 \\
		\hline

		DRY violations & 4 & 5 & 4,5 \\
		\hline

		God Functions & 3 & 4 & 3,5 \\
		\hline

		Complex statements & 3 & 3 & 3 \\
		\hline

		High Arity & 2 & 2 & 2 \\
		\hline

		Image based tests & 3 & 4 & 3,5 \\
		\hline

		Property based tests & 2 & 2 & 2 \\
		\hline

		Coordinates based tests & 4 & 5 & 4,5 \\
		\hline

	\end{tabu}
	\caption{Interest magnitude as perceived by interviewees.}
	\label{tab:interest_magnitude}
\end{table}

\todo{Fix stacked plotbar and proof read all the results sections}


